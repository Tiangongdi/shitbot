# 计时器工具使用指南 -- 本文档详细介绍了 ShitBot 工具模块中计时器相关工具的使用方法、参数说明、使用示例以及最佳实践。

## 工具概述

计时器工具模块提供了多种定时任务功能，包括一次性延迟执行、周期性执行、每日定时执行等。这些工具可以帮助用户实现自动化任务调度。

## once_after - 一次性延迟执行

### 工具介绍
在指定时间后执行一次任务。

### 工具参数
- `time` (必需): 延迟时间，单位为秒（整数类型）
- `task` (必需): 任务描述（字符串类型）

### 使用示例
```
# 5分钟后执行任务
once_after(time=300, task="发送提醒邮件")

# 1小时后执行备份任务
once_after(time=3600, task="执行数据库备份")
```

## interval - 周期性执行

### 工具介绍
按照指定的时间间隔周期性执行任务，可以设置执行次数或无限次执行。

### 工具参数
- `interval_seconds` (必需): 时间间隔，单位为秒（整数类型）
- `interval_count` (必需): 触发次数，-1 表示无限次（整数类型）
- `task` (必需): 任务描述（字符串类型）

### 使用示例
```
# 每10分钟执行一次，共执行6次
interval(interval_seconds=600, interval_count=6, task="检查系统状态")

# 每5秒执行一次，无限次执行
interval(interval_seconds=5, interval_count=-1, task="监控日志文件")
```

## daily_at - 每日定时执行

### 工具介绍
每天在指定的时间执行任务。

### 工具参数
- `hour` (必需): 小时，范围 0-23（整数类型）
- `minute` (可选): 分钟，范围 0-59，默认为 0（整数类型）
- `task` (必需): 任务描述（字符串类型）

### 使用示例
```
# 每天早上8点执行
daily_at(hour=8, task="发送日报")

# 每天晚上11点30分执行
daily_at(hour=23, minute=30, task="执行夜间备份")
```

## cancel - 取消定时任务

### 工具介绍
取消指定的定时任务。

### 工具参数
- `task_id` (必需): 要取消的任务ID（字符串类型）

### 使用示例
```
# 取消指定任务
cancel(task_id="task_123456")
```

## pause - 暂停定时任务

### 工具介绍
暂停指定的定时任务，暂停后可以恢复。

### 工具参数
- `task_id` (必需): 要暂停的任务ID（字符串类型）

### 使用示例
```
# 暂停指定任务
pause(task_id="task_123456")
```

## resume - 恢复定时任务

### 工具介绍
恢复已暂停的定时任务。

### 工具参数
- `task_id` (必需): 要恢复的任务ID（字符串类型）

### 使用示例
```
# 恢复指定任务
resume(task_id="task_123456")
```

## list - 列出所有定时任务

### 工具介绍
列出当前所有的定时任务及其状态。

### 工具参数
无参数

### 使用示例
```
# 查看所有定时任务
list()
```

## 典型使用场景

### 场景1：定时提醒
```
# 30分钟后提醒用户休息
once_after(time=1800, task="提醒用户休息眼睛")
```

### 场景2：定期数据备份
```
# 每天凌晨2点执行数据备份
daily_at(hour=2, task="执行数据备份")
```

### 场景3：实时监控
```
# 每30秒检查一次服务状态
interval(interval_seconds=30, interval_count=-1, task="检查服务状态")
```

### 场景4：批量任务处理
```
# 每5分钟处理一次队列任务，共处理12次
interval(interval_seconds=300, interval_count=12, task="处理队列任务")
```

## 注意事项

1. **时间单位**: 所有时间参数都以秒为单位，请确保正确换算
2. **任务ID管理**: 取消、暂停、恢复任务时需要正确的任务ID
3. **资源占用**: 无限次执行的任务可能会占用较多系统资源
4. **任务描述**: 任务描述应清晰明了，便于后续管理
5. **时间范围**: daily_at 的小时参数必须在 0-23 范围内

## 最佳实践

1. **合理设置间隔**: 根据实际需求设置合适的时间间隔，避免过于频繁
2. **任务描述规范**: 使用统一的任务描述格式，便于管理和搜索
3. **定期清理**: 及时取消不再需要的定时任务
4. **错误处理**: 在任务执行时考虑异常情况的处理
5. **日志记录**: 重要任务建议添加日志记录功能

## 快速参考

| 工具名称 | 功能描述 | 关键参数 |
|---------|---------|---------|
| once_after | 一次性延迟执行 | time, task |
| interval | 周期性执行 | interval_seconds, interval_count, task |
| daily_at | 每日定时执行 | hour, minute, task |
| cancel | 取消任务 | task_id |
| pause | 暂停任务 | task_id |
| resume | 恢复任务 | task_id |
| list | 列出所有任务 | 无 |

## 常见问题

**Q: 如何查看当前有哪些定时任务？**
A: 使用 `list()` 工具可以查看所有定时任务及其状态。

**Q: 如何停止一个无限循环的任务？**
A: 使用 `cancel(task_id)` 工具取消任务，或使用 `pause(task_id)` 暂停任务。

**Q: 可以同时运行多个定时任务吗？**
A: 可以，计时器工具支持同时运行多个定时任务。

**Q: 任务执行失败会自动重试吗？**
A: 不会，如果需要重试机制，需要在任务描述中自行实现。
